<!--original source: https://gist.github.com/knjcode/9081842644bc0b49a180 -- copied for personal use -->
<html>
  <head>
    <title>Animation Frame Counter</title>
    <meta name="viewport" content="width=device-width">
    <script src="http://fb.me/react-0.13.1.js"></script>
    <script src="http://fb.me/JSXTransformer-0.13.1.js"></script>
  </head>
  <body>
  <script type="text/jsx">
    var getTimeSpan = function(elapsed) { // 754567(ms) -> "12:34.567"
        var m = String(Math.floor(elapsed/1000/60)+100).substring(1);
        var s = String(Math.floor((elapsed%(1000*60))/1000)+100).substring(1);
        var ms = ((elapsed % 1000) / 1000).toFixed(2).substring(2);
        return m+":"+s+"."+ms;
      }
    var TimeWithFrames = React.createClass({
      render: function() {
        var time = this.props.time // in seconds
        var fps = this.props.fps
        return (
          <span>
            { this.props.children }
            { ' ' + getTimeSpan(time) } &mdash; <strong>{ Math.round(fps * time / 1000) }</strong> frames
          </span>
        )
      }
    })
    var StopWatch = React.createClass({
      getInitialState: function() {
        return {
          isStart: false,
          elapsed: 0,
          diff: 0,
          fps: 24,
          laps: [],
        };
      },
      componentWillUnmount: function() { // clear timer
        clearInterval(this.state.timer);
        this.setState({timer: undefined});
      },
      tick: function() {
        var elapsed = Date.now() - this.state.start + this.state.diff;
        this.setState({elapsed: elapsed});
      },
      
      onClick: function() {
        if(!this.state.isStart) { // start
          var timer = setInterval(this.tick, 33);
          this.setState({
            isStart: true,
            timer: timer,
            start: new Date(),
          });
        } else { // pause
          clearInterval(this.state.timer);
          this.setState({
            timer: undefined,
            isStart: false,
            diff: this.state.elapsed,
          });
        }
      },
      setFPS: function (e) {
        this.setState({ fps: e.target.value })
      },
      setLap: function() {
        var lapElapsed = this.state.laps.length ? this.state.laps[0].elapsed : 0;
        var lapTitle = "Lap " + (this.state.laps.length+1);
        var lapTime = this.state.elapsed - lapElapsed
        var lapLabel = lapTitle + ": " + lapTime
        var lapElem =
          { label: lapTime
          , elapsed: this.state.elapsed
          , id: lapLabel
          , time: lapTime
          , title: lapTitle
          };
        this.setState({laps: [lapElem].concat(this.state.laps)});
      },
      reset: function() {
        clearInterval(this.state.timer);
        this.setState({
          timer: undefined,
          isStart: false,
          elapsed: 0,
          diff: 0,
          laps: [],
        });
      },
      render: function() {
        var fps = this.state.fps
        return (
          <div style={style.container}>
           <div style={style.inner}>
            <h1>
              <TimeWithFrames fps={fps}
                time={this.state.elapsed}/>
            </h1>
            <button onClick={this.onClick} style={style.button}>
              {this.state.isStart ? "pause" : "start"}
            </button>
            <button onClick={this.setLap} style={style.button}>lap</button>
            <button onClick={this.reset} style={style.button}>reset</button>
            <div style={style.fps}>
              <label htmlFor="fps">FPS:</label>
              <select name="fps"
               value={fps}
               onChange={this.setFPS}
               style={style.fps}>
               <option key={12} value={12}>
                 12
               </option>
               <option key={24} value={24}>
                 24
               </option>
               <option key={30} value={30}>
                 30
               </option>
               <option key={48} value={48}>
                 48
               </option>
               <option key={60} value={60}>
                 60
               </option>
              </select>
            </div>
            <ul style={style.lap}>
              {this.state.laps.map(function(lap) {
                return <li key={lap.id}>
                    <TimeWithFrames fps={fps}
                        time={lap.time}>
                      {lap.title}
                    </TimeWithFrames>
                  </li>;
              })}
            </ul>
           </div>
          </div>
        );
      }
    });

    var style = {
      container: {
        textAlign: 'center',
        padding: 10,
      },
      inner: {
        margin: '5px auto',
        border: "1px solid #eee"
      },
      button: {
        fontSize: 20,
        height: 44,
        width: 88,
        margin: 5,
      },
      lap: {
        fontSize: 28,
        padding: 5,
        listStyleType: 'none',
      },
      fps: {
        fontSize: 28
      }
    };

    React.render( <StopWatch />, document.body );
  </script>
  </body>
</html>
